---
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/sections/Hero.astro';
import AboutPreview from '../components/sections/AboutPreview.astro';
import Services from '../components/sections/Services.astro';
import PortfolioPreview from '../components/sections/PortfolioPreview';
import Testimonials from '../components/sections/Testimonials.astro';
import InstagramGallery from '../components/sections/InstagramGallery.astro';
import CtaSection from '../components/sections/CtaSection.astro';
import { sanityClient } from '../lib/sanity';
import { impostazioniQuery } from '../lib/queries';

let impostazioni: any = null;
try {
  impostazioni = await sanityClient.fetch(impostazioniQuery);
} catch (e) {
  console.error('Sanity fetch failed, using fallback values:', e);
}
---

<BaseLayout
  title="Wedding Planner Roma | Gaia Events — Matrimoni ed Eventi Esclusivi"
  description={impostazioni?.descrizione || 'Gaia Events — Wedding Planner & Event Manager a Roma. Esclusività e ricercatezza per il giorno più importante della tua vita.'}
>
  <main>
    <Hero
      titolo={impostazioni?.heroHomepage?.titolo}
      sottotitolo={impostazioni?.heroHomepage?.sottotitolo}
      immagine={impostazioni?.heroHomepage?.immagine}
    />
    <AboutPreview
      foto={impostazioni?.chiSono?.foto}
      titolo={impostazioni?.chiSono?.titolo}
      testoPrincipale={impostazioni?.chiSono?.testoPrincipale}
      testoLink={impostazioni?.chiSono?.testoLink}
    />
    <Services />
    <PortfolioPreview client:visible />
    <Testimonials />
    <InstagramGallery />
    <CtaSection />
  </main>
</BaseLayout>
